<!--
=========================================================
* Material Dashboard 2 - v3.1.0
=========================================================

* Product Page: https://www.creative-tim.com/product/material-dashboard
* Copyright 2023 Creative Tim (https://www.creative-tim.com)
* Licensed under MIT (https://www.creative-tim.com/license)
* Coded by Creative Tim

=========================================================

* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
-->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="apple-touch-icon" sizes="76x76" href="../assets/img/apple-icon.png">
  <link rel="icon" type="image/png" href="../assets/img/favicon.png">
  <title>
    Material Dashboard 2 by Creative Tim
  </title>
  <!--     Fonts and icons     -->
  <link rel="stylesheet" type="text/css"
    href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,900|Roboto+Slab:400,700" />
  <!-- Nucleo Icons -->
  <link href="../assets/css/nucleo-icons.css" rel="stylesheet" />
  <link href="../assets/css/nucleo-svg.css" rel="stylesheet" />
  <!-- Font Awesome Icons -->
  <script src="https://kit.fontawesome.com/42d5adcbca.js" crossorigin="anonymous"></script>
  <!-- Material Icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
  <!-- CSS Files -->
  <link id="pagestyle" href="../assets/css/material-dashboard.css?v=3.1.0" rel="stylesheet" />
  <!-- Nepcha Analytics (nepcha.com) -->
  <!-- Nepcha is a easy-to-use web analytics. No cookies and fully compliant with GDPR, CCPA and PECR. -->
  <script defer data-site="YOUR_DOMAIN_HERE" src="https://api.nepcha.com/js/nepcha-analytics.js"></script>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script src="../config.js"></script>


  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f4f4f4;
    }

    html,
    body {
      height: 100%;
      overflow: auto;
      /* Ensure overflow is set to auto or visible */
    }

    table {
      width: 100%;
      border-collapse: collapse;
      max-width: 80%;
      margin: 0 auto;
    }

    th,
    td {
      border: 1px solid #ddd;
      padding: 8px;
      font-size: 10px;
    }

    th {
      background-color: #f4f4f4;
      text-align: left;
    }

    tr:nth-child(even) {
      background-color: #f9f9f9;
    }

    .container {
      width: 100%;
      margin: 0 auto;
      padding: 20px;
      background-color: white;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    .header,
    .footer {
      text-align: center;
      padding: 20px;
      color: #333;
      color: white;
    }

    .content {
      margin-left: 20px;
      text-align: left;
    }

    .content h2 {
      color: #333;
    }

    .content p {
      color: #666;
    }

    .cta {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: 20px;
      margin-bottom: 20px;
    }

    .cta img {
      max-width: 50%;
      height: auto;
      margin-right: 100px;
    }

    .cta .button-container {
      margin-left: 20px;
    }

    .cta button {
      padding: 10px 20px;
      background-color: #28a745;
      color: white;
      border: none;
      cursor: pointer;
      font-size: 16px;
    }

    .cta button:hover {
      background-color: #218838;
    }

    /* New styles for custom amount input field */
    .custom-amount-field {
      border: 1px solid black;
      /* Green border color */
      border-radius: 4px;
      /* Rounded corners */
      padding: 10px;
      /* Add padding to create space inside the input field */
      transition: border-color 0.3s;
      /* Smooth transition for border color change */
    }

    .custom-amount-field:focus {
      border-color: black;
      /* Darker green when focused */
      outline: none;
      /* Remove the default outline */
    }

    /* Styles for the select input */
    .form-select {
      border: 1px solid black;
      /* Green border color */
      border-radius: 4px;
      /* Rounded corners */
      padding: 10px;
      /* Add padding to create space inside the select field */
      transition: border-color 0.3s;
      /* Smooth transition for border color change */
    }

    .form-select:focus {
      border-color: black;
      /* Darker green when focused */
      outline: none;
      /* Remove the default outline */
    }

    .main-content {
      height: auto;
      /* Allow it to grow with content */
      max-height: none;
      /* Remove max-height restriction */
    }
  </style>
</head>

<body class="g-sidenav-show  bg-gray-200">
  <aside
    class="sidenav navbar navbar-vertical navbar-expand-xs border-0 border-radius-xl my-3 fixed-start ms-3   bg-gray-900"
    id="sidenav-main">
    <div class="sidenav-header">
      <i class="fas fa-times p-3 cursor-pointer text-white opacity-5 position-absolute end-0 top-0 d-none d-xl-none"
        aria-hidden="true" id="iconSidenav"></i>
      <a class="navbar-brand m-0" href=" https://demos.creative-tim.com/material-dashboard/pages/dashboard "
        target="_blank">
        <center><img src="../assets/img/logo-onesadaqah.png" class="navbar-brand-img h-100" alt="main_logo"></center>
      </a>
    </div>
    <hr class="horizontal light mt-0 mb-2">
    <div class="collapse navbar-collapse  w-auto " id="sidenav-collapse-main">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link text-white " href="../pages/dashboard.html">
            <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
              <i class="material-icons opacity-10">dashboard</i>
            </div>
            <span class="nav-link-text ms-1">Dashboard</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white " href="../pages/Zakat.html">
            <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
              <i class="material-icons opacity-10">view_in_ar</i><!-- Tukar icon -->
            </div>
            <span class="nav-link-text ms-1">Zakat</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white active bg-gradient-info" href="../pages/Charity.html">
            <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
              <i class="material-icons opacity-10">table_view</i>
            </div>
            <span class="nav-link-text ms-1">Charity</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white " href="../pages/billing.html">
            <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
              <i class="material-icons opacity-10">receipt_long</i>
            </div>
            <span class="nav-link-text ms-1">Billing</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white " href="../pages/notifications.html">
            <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
              <i class="material-icons opacity-10">notifications</i>
            </div>
            <span class="nav-link-text ms-1">Fidyah</span>
          </a>
        </li>
        <li class="nav-item mt-3">
          <h6 class="ps-4 ms-2 text-uppercase text-xs text-white font-weight-bolder opacity-8">Account pages</h6>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white " href="../pages/profile.html">
            <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
              <i class="material-icons opacity-10">person</i>
            </div>
            <span class="nav-link-text ms-1">Profile</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white " href="../pages/sign-in.html">
            <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
              <i class="material-icons opacity-10">login</i>
            </div>
            <span class="nav-link-text ms-1">Sign In</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white " href="../pages/sign-up.html">
            <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
              <i class="material-icons opacity-10">assignment</i>
            </div>
            <span class="nav-link-text ms-1">Sign Up</span>
          </a>
        </li>
      </ul>
    </div>
  </aside>
  <main class="main-content position-relative max-height-vh-100 h-100 border-radius-lg" id="myApp">
    <!-- Navbar -->
    <nav class="navbar navbar-main navbar-expand-lg px-0 mx-4 shadow-none border-radius-xl" id="navbarBlur"
      data-scroll="true">
      <div class="container-fluid py-1 px-3">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb bg-transparent mb-0 pb-0 pt-1 px-0 me-sm-6 me-5">
            <li class="breadcrumb-item text-sm"><a class="opacity-5 text-dark" href="javascript:;">Pages</a></li>
            <li class="breadcrumb-item text-sm text-dark active" aria-current="page">Template</li>
          </ol>
          <h6 class="font-weight-bolder mb-0">Template</h6>
        </nav>
        <div class="collapse navbar-collapse mt-sm-0 mt-2 me-md-0 me-sm-4" id="navbar">
          <div class="ms-md-auto pe-md-3 d-flex align-items-center">
            <div class="input-group input-group-outline">

              <div class="wallet-container d-flex align-items-center">
                <img src="../assets/img/icons8-wallet.png" alt="Wallet Icon" class="wallet-icon me-2" />
                <span class="wallet-balance">{{ tokenBalance }}</span>
              </div>
            </div>
          </div>
        </div>
        <ul class="navbar-nav  justify-content-end">

          <li class="mt-2">

          </li>
          <li class="nav-item d-xl-none ps-3 d-flex align-items-center">
            <a href="javascript:;" class="nav-link text-body p-0" id="iconNavbarSidenav">
              <div class="sidenav-toggler-inner">
                <i class="sidenav-toggler-line"></i>
                <i class="sidenav-toggler-line"></i>
                <i class="sidenav-toggler-line"></i>
              </div>
            </a>
          </li>
          <li class="nav-item px-3 d-flex align-items-center">
            <a href="javascript:;" class="nav-link text-body p-0">
              <i class="fa fa-cog fixed-plugin-button-nav cursor-pointer"></i>
            </a>
          </li>
          <li class="nav-item dropdown pe-2 d-flex align-items-center">
            <a href="javascript:;" class="nav-link text-body p-0" id="dropdownMenuButton" data-bs-toggle="dropdown"
              aria-expanded="false">
              <i class="fa fa-bell cursor-pointer"></i>
            </a>
            <ul class="dropdown-menu  dropdown-menu-end  px-2 py-3 me-sm-n4" aria-labelledby="dropdownMenuButton">
              <li class="mb-2">
                <a class="dropdown-item border-radius-md" href="javascript:;">
                  <div class="d-flex py-1">
                    <div class="my-auto">
                      <img src="../assets/img/team-2.jpg" class="avatar avatar-sm  me-3 ">
                    </div>
                    <div class="d-flex flex-column justify-content-center">
                      <h6 class="text-sm font-weight-normal mb-1">
                        <span class="font-weight-bold">New message</span> from Laur
                      </h6>
                      <p class="text-xs text-secondary mb-0">
                        <i class="fa fa-clock me-1"></i>
                        13 minutes ago
                      </p>
                    </div>
                  </div>
                </a>
              </li>
              <li class="mb-2">
                <a class="dropdown-item border-radius-md" href="javascript:;">
                  <div class="d-flex py-1">
                    <div class="my-auto">
                      <img src="../assets/img/small-logos/logo-spotify.svg"
                        class="avatar avatar-sm bg-gradient-dark  me-3 ">
                    </div>
                    <div class="d-flex flex-column justify-content-center">
                      <h6 class="text-sm font-weight-normal mb-1">
                        <span class="font-weight-bold">New album</span> t
                      </h6>
                      <p class="text-xs text-secondary mb-0">
                        <i class="fa fa-clock me-1"></i>
                        1 day
                      </p>
                    </div>
                  </div>
                </a>
              </li>
              <li>
                <a class="dropdown-item border-radius-md" href="javascript:;">
                  <div class="d-flex py-1">
                    <div class="avatar avatar-sm bg-gradient-secondary  me-3  my-auto">
                      <svg width="12px" height="12px" viewBox="0 0 43 36" version="1.1"
                        xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <title>credit-card</title>
                        <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                          <g transform="translate(-2169.000000, -745.000000)" fill="#FFFFFF" fill-rule="nonzero">
                            <g transform="translate(1716.000000, 291.000000)">
                              <g transform="translate(453.000000, 454.000000)">
                                <path class="color-background"
                                  d="M43,10.7482083 L43,3.58333333 C43,1.60354167 41.3964583,0 39.4166667,0 L3.58333333,0 C1.60354167,0 0,1.60354167 0,3.58333333 L0,10.7482083 L43,10.7482083 Z"
                                  opacity="0.593633743"></path>
                                <path class="color-background"
                                  d="M0,16.125 L0,32.25 C0,34.2297917 1.60354167,35.8333333 3.58333333,35.8333333 L39.4166667,35.8333333 C41.3964583,35.8333333 43,34.2297917 43,32.25 L43,16.125 L0,16.125 Z M19.7083333,26.875 L7.16666667,26.875 L7.16666667,23.2916667 L19.7083333,23.2916667 L19.7083333,26.875 Z M35.8333333,26.875 L28.6666667,26.875 L28.6666667,23.2916667 L35.8333333,23.2916667 L35.8333333,26.875 Z">
                                </path>
                              </g>
                            </g>
                          </g>
                        </g>
                      </svg>
                    </div>
                    <div class="d-flex flex-column justify-content-center">
                      <h6 class="text-sm font-weight-normal mb-1">
                        Payment successfully completed
                      </h6>
                      <p class="text-xs text-secondary mb-0">
                        <i class="fa fa-clock me-1"></i>
                        2 days
                      </p>
                    </div>
                  </div>
                </a>
              </li>
            </ul>
          </li>
          <li class="nav-item d-flex align-items-center">
            <a href="../pages/sign-in.html" class="nav-link text-body font-weight-bold px-0">
              <i class="fa fa-user me-sm-1"></i>
              <span class="d-sm-inline d-none">Sign In</span>
            </a>
          </li>
        </ul>
      </div>
      </div>
    </nav>
    <div class="header">
      <h1>Welcome to Crowdfunding For Rumah Charity </h1>
    </div>
    <div class="container">
      <div class="content">
        <h2>About the Project</h2>
        <p>We are excited to present our new innovative product that will revolutionize the way you live. Join us on
          this journey to make this dream a reality.</p>
        <div class="cta">
          <img src="../assets/img/oldfolks.jpeg" alt="Project Image">

          <div class="button-container">
            <div class="card my-4">
              <div class="card-header p-0 position-relative mt-n4 mx-3 z-index-2">
                <div class="bg-gradient-success shadow-primary border-radius-lg pt-4 pb-3">
                  <h6 class="text-white text-capitalize ps-6">Donate Here</h6>
                </div>
              </div>
              <div class="card-body px-0 pb-2">
                <div class="table-responsive p-0">
                  <table class="table align-items-center mb-0">
                    <tbody>
                      <tr>
                        <td>
                          Progress:
                        </td>
                        <td class="align-middle text-center">
                          <div class="d-flex align-items-center justify-content-center">
                            <span class="me-2 text-xs font-weight-bold">60%</span>
                            <div>
                              <div class="progress">
                                <div class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="60"
                                  aria-valuemin="0" aria-valuemax="100" style="width: 60%;"></div>
                              </div>
                            </div>
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td>
                          Achieved:
                        </td>
                        <td class="align-middle text-left text-sm">
                          <p class="text-sm font-weight-bold mb-0">$5,000</p>
                        </td>
                      </tr>
                      <tr>
                        <td>
                          Target:
                        </td>
                        <td class="align-middle text-left text-sm">
                          <p class="text-sm font-weight-bold mb-0">$5,000</p>
                        </td>
                      </tr>
                      <tr>
                        <td colspan="2">
                          <!-- <form> -->
                          <!-- <div class="mb-3">
                              <label for="presetAmount" class="form-label">Choose donation amount</label>
                              <select class="form-select" id="presetAmount" v-model="transferInput.selectedAmount"
                                name="amount" aria-label="Select donation amount">
                                <option selected>Choose amount</option>
                                <option value="20">$20</option>
                                <option value="50">$50</option>
                                <option value="100">$100</option>
                                <option value="200">$200</option>
                              </select>
                            </div> -->
                          <div class="mb-3">
                            <label for="customAmount" class="form-label">Enter your own amount</label>
                            <input type="number" class="form-control custom-amount-field" id="customAmount"
                              v-model="transferInput.customAmount" name="custom_amount" placeholder="Enter amount"
                              aria-label="Enter your own amount" min="1">
                          </div>
                          <button v-on:click="transferTokens()" class="btn btn-success">Donate
                            Here</button>
                          <!-- </form> -->
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>

        </div>
        <p>This project aims to solve everyday problems with an efficient and sustainable solution. With your support,
          we can bring this project to life and make a positive impact.</p>

        <!-- Display results in a table -->
        <div v-if="transactions.length">
          <h2>Transactions</h2>
          <table>
            <thead>
              <tr>
                <th>From</th>
                <th>To</th>
                <th>Amount</th>
                <th>Timestamp</th>
                <th>Transaction ID</th>
              </tr>
            </thead>
            <tbody>
              <tr v-for="transaction in transactions" :key="transaction.transactionHash">
                <td>{{ transaction.from }}</td>
                <td>{{ transaction.to }}</td>
                <td>{{ transaction.amount }} {{ transaction.token.symbol }}</td>
                <td>{{ transaction.timestamp }}</td>
                <td>{{ transaction.transactionHash }}</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div v-else>
          <p>No transactions found.</p>
        </div>

      </div>

    </div>


  </main>

  <!--   Core JS Files   -->
  <script src="../assets/js/core/popper.min.js"></script>
  <script src="../assets/js/core/bootstrap.min.js"></script>
  <script src="../assets/js/plugins/perfect-scrollbar.min.js"></script>
  <script src="../assets/js/plugins/smooth-scrollbar.min.js"></script>
  <script>
    var win = navigator.platform.indexOf('Win') > -1;
    if (win && document.querySelector('#sidenav-scrollbar')) {
      var options = {
        damping: '0.5'
      }
      Scrollbar.init(document.querySelector('#sidenav-scrollbar'), options);
    }
  </script>
  <!-- Github buttons -->
  <script async defer src="https://buttons.github.io/buttons.js"></script>
  <!-- Control Center for Material Dashboard: parallax effects, scripts for the example pages etc -->
  <script src="../assets/js/material-dashboard.min.js?v=3.1.0"></script>
</body>
<script>
  const vueApp = Vue.createApp({
    data() {
      return {
        client_id: window.env.client_id,
        client_secret: window.env.client_secret,
        balanceWalletAddress: "",
        balanceContractAddress: "",
        tokenBalance: null,
        transferInput: {
          customAmount: "1",
        },
        transferWalletAddress: "",
        transferToAddress: "",
        transferAmount: "",
        transferContractAddress: "",
        callbackUrl: "",
        transferResponse: null,
        transactionFilter: "to",
        transactions: []
      }
    },
    mounted() {
      this.fetchTokenBalance();
      this.fetchTransactions();
    },
    methods: {
      async fetchTokenBalance() {

        const payload = {
          wallet_address: window.env.wallet_address2,
          contract_address: window.env.transferContractAddress,
        };

        try {
          const res = await axios.post(
            "https://service-testnet.maschain.com/api/token/balance",
            payload,
            {
              headers: {
                client_id: this.client_id,
                client_secret: this.client_secret,
              },
            }
          );   

          const rawBalance = parseFloat(res.data.result);

          this.tokenBalance = rawBalance.toFixed(2) + ' SDG';
        } catch (error) {
          console.error("Error fetching token balance:", error);
          this.tokenBalance = error.response ? error.response.data : "An error occurred";
        }
      },
      async transferTokens() {
        // if (!this.transferWalletAddress || !this.transferToAddress || !this.transferAmount || !this.transferContractAddress) {
        //   alert("Please fill in all fields");
        //   return;
        // }
        console.log(this.transferInput.customAmount);

        if (!this.transferInput.customAmount) {
          alert("Please fill in the amounts");
          return;
        }
        // if (this.selectedAmount && this.customAmount) {
        //   alert("Please choose between choose amount or enter custom amount");
        //   return;
        // }

        this.transferAmount = this.transferInput.customAmount;

        const payload = {
          wallet_address: window.env.wallet_address2,
          to: window.env.transferToAddress1,
          amount: this.transferAmount,
          contract_address: window.env.transferContractAddress,
          callback_url: window.env.callbackUrl,
        };

        try {
          const res = await axios.post(
            "https://service-testnet.maschain.com/api/token/token-transfer",
            payload,
            {
              headers: {
                client_id: this.client_id,
                client_secret: this.client_secret,
              },
            }
          );
          this.transferResponse = res.data.result;
          alert("Transfer successful!");
        } catch (error) {
          console.error("Error transferring tokens:", error);
          this.transferResponse = error.response ? error.response.data : "An error occurred";
          alert("Error transferring tokens. Please try again.");
        }
      },
      // async getTokenTransactions() {
      //   const params = {
      //     wallet_address: window.env.transferToAddress1,
      //     contract_address: window.env.transferContractAddress,
      //     filter: this.transactionFilter,
      //   };

      //   try {
      //     const res = await axios.get(
      //       "https://service-testnet.maschain.com/api/token/get-token-transaction",
      //       {
      //         headers: {
      //           client_id: this.client_id,
      //           client_secret: this.client_secret,
      //           "content-type": "application/json",
      //         },
      //         params: params,
      //       }
      //     );
      //     this.transactions = res.data;
      //   } catch (error) {
      //     console.error("Error fetching token transactions:", error);
      //     this.tokenTransactions = error.response ? error.response.data : "An error occurred";
      //     this.transactions = [];
      //   }
      // },
      async fetchTransactions() {
        const walletAddress = window.env.transferToAddress1;
        const contractAddress = window.env.transferContractAddress;
        const filter = 'to'; // or 'from'

        const url = `https://service-testnet.maschain.com/api/token/get-token-transaction?wallet_address=${encodeURIComponent(walletAddress)}&contract_address=${encodeURIComponent(contractAddress)}&filter=${encodeURIComponent(filter)}`;

        try {
          const response = await fetch(url, {
            headers: {
              'client_id': this.client_id,
              'client_secret': this.client_secret,
              'content-type': 'application/json'
            }
          });

          if (!response.ok) {
            throw new Error('Network response was not ok');
          }

          const data = await response.json();
          this.transactions = data.result || [];
        } catch (error) {
          console.error('Error fetching transactions:', error);
        }
      },
    },
  });
  vueApp.mount("#myApp");
</script>

</html>